# 🎓 바이오헬스 융합인재 이노베이터 for KDT
## 교육 관리 시스템 - 완전판 v3.0

![Python](https://img.shields.io/badge/Python-3.10-blue)
![PyQt5](https://img.shields.io/badge/PyQt5-5.15-green)
![MySQL](https://img.shields.io/badge/MySQL-8.0-orange)
![ReportLab](https://img.shields.io/badge/ReportLab-4.0-red)

## 🎉 완성된 모든 기능

### ✅ 1. 데이터베이스 연동
- MySQL 실시간 연결 (bitnmeta2.synology.me:3307)
- 7개 테이블 자동 생성
- 외래키 관계 설정

### ✅ 2. Excel 내보내기/가져오기
- 모든 데이터 Excel 내보내기
- 타임스탬프 자동 추가
- 포맷팅 및 자동 열 너비 조정
- Excel 파일에서 일괄 가져오기

### ✅ 3. 강사 코드 관리 (IC-xxx)
- 코드 자동 생성
- 주강사/보조강사/멘토 구분
- CRUD 완벽 지원

### ✅ 4. 강사 관리 (T-xxx)
- 이름, 연락처, 전공, 이메일
- 강사 구분 연동
- 완전한 데이터 관리

### ✅ 5. 교과목 관리 (G-xxx)
- 과목명, 수업시수
- 주강사/보조강사/예비강사 배정
- 강사 연동

### ✅ 6. 공휴일 관리
- **법정공휴일 자동 입력** (2025년 한국 공휴일)
- 수동 입력 (구정, 추석 등)
- 시간표 생성 시 자동 제외

### ✅ 7. 과정 관리 (C-xxx)
- 반명칭, 강의장소
- 강의/프로젝트/인턴쉽 시수
- 인원수, 특이사항

### ✅ 8. 시간표 자동 생성 ⭐
- **공휴일/토요일/일요일 자동 제외**
- 강의 → 프로젝트 → 인턴쉽 순차 배치
- 교과목 및 강사 자동 배정
- 하루 8시간 기준 자동 계산
- 미리보기 기능

### ✅ 9. 프로젝트 관리 (P-xxx)
- 프로젝트명, 과정 연결
- 구성원 1~5명 (이름, 연락처)
- 팀 관리 기능

### ✅ 10. 시간표 조회/수정 ⭐
#### 📋 테이블 뷰
- 과정/유형/날짜 필터링
- 개별 시간표 수정
- 교과목/강사 변경

#### 📅 달력 뷰
- 시각적 일정 확인
- 날짜별 색상 구분
  - 파랑: 강의
  - 주황: 프로젝트
  - 초록: 인턴쉽
- 날짜 클릭 시 상세 일정 표시

#### 👨‍🏫 강사별 스케줄
- 강사별 전체 일정 조회
- 날짜 범위 필터링
- 시간 충돌 확인 가능

### ✅ 11. PDF 보고서 생성 ⭐
#### 📋 시간표 보고서
- 과정 정보 포함
- 전체 일정 PDF화
- 한글 지원
- 컬러 포맷팅

#### 📝 출석부 양식
- 학생 명단 자동 생성
- 날짜별 출석 체크 칸
- 최대 20일분 양식

#### 📊 성적표 양식
- 학생 명단 자동 생성
- 교과목별 성적 입력 칸
- 평균/등급 칸 포함

---

## 📊 시스템 구조

### 데이터베이스 (7개 테이블)
```
instructor_codes ─┐
                  ├─> instructors ─┬─> subjects ─> timetables
                  │                 │
holidays          │                 └─> courses ─┬─> timetables
                  │                               └─> projects
```

### 애플리케이션 구조
```
KDT Main Window
├── 기본 관리
│   ├── 강사 코드 관리
│   ├── 강사 관리
│   ├── 교과목 관리
│   └── 공휴일 관리
│
├── 과정 관리
│   ├── 과정 관리
│   └── 프로젝트 관리
│
├── 시간표
│   ├── 시간표 자동 생성 ⭐
│   └── 시간표 조회/수정 ⭐
│       ├── 테이블 뷰
│       ├── 달력 뷰
│       └── 강사별 스케줄
│
├── Excel
│   ├── 내보내기
│   └── 가져오기
│
└── 보고서 ⭐
    ├── 시간표 PDF
    ├── 출석부 양식
    └── 성적표 양식
```

---

## 🚀 사용 방법

### 설치
```bash
# 1. Conda 환경 생성
conda create -n pyqt5_app python=3.10 -y
conda activate pyqt5_app

# 2. 패키지 설치
pip install -r requirements.txt
```

### 실행
```bash
# Windows
run_kdt_full.bat

# 또는
conda activate pyqt5_app
python main_kdt_full.py
```

### 첫 실행 순서
1. **데이터베이스 초기화** 버튼 클릭
2. **공휴일 관리** → "법정공휴일 자동 입력"
3. **강사 코드 관리** → 강사 구분 생성
4. **강사 관리** → 강사 등록
5. **교과목 관리** → 과목 등록 및 강사 배정
6. **과정 관리** → 과정 생성
7. **시간표 자동 생성** → 시간표 생성 ⭐
8. **시간표 조회** → 확인 및 수정
9. **PDF 보고서 생성** → 시간표 출력 ⭐

---

## 📖 주요 기능 사용 가이드

### 1. 시간표 자동 생성
```
시간표 → 시간표 자동 생성
1. 과정 선택
2. 시작일 설정
3. 수업 시간 설정 (09:00 ~ 18:00)
4. 미리보기로 확인
5. 생성하기 클릭

✨ 자동 처리 사항:
- 공휴일 제외
- 토요일, 일요일 제외
- 강의 → 프로젝트 → 인턴쉽 순차 배치
- 교과목 순차 배정
- 주강사 자동 배정
```

### 2. 시간표 조회/수정
```
시간표 → 시간표 조회/수정

📋 테이블 뷰:
- 과정/유형/날짜로 필터링
- 행 클릭 후 수정
- 저장 버튼으로 적용

📅 달력 뷰:
- 색상으로 유형 구분
- 날짜 클릭 시 상세 일정 표시

👨‍🏫 강사별 스케줄:
- 강사 선택
- 기간 설정
- 전체 일정 확인
```

### 3. PDF 보고서 생성
```
보고서 → PDF 보고서 생성

📋 시간표 보고서:
- 과정 선택
- 생성하기 클릭
- PDF 파일 자동 저장

📝 출석부 양식:
- 과정 선택
- 학생 명단 자동 포함
- 빈 출석 칸 생성

📊 성적표 양식:
- 과정 선택
- 교과목 자동 포함
- 빈 성적 입력 칸 생성
```

---

## 📁 프로젝트 파일 구조

```
pyqt5_app/
├── 🚀 main_kdt_full.py              메인 실행 파일
├── 🪟 run_kdt_full.bat              Windows 실행 스크립트
├── ⚙️ config_db.py                  DB 설정
├── 📄 requirements.txt              패키지 목록
│
├── database/
│   ├── __init__.py
│   └── db_manager.py               DB 연결 및 테이블 관리
│
├── ui/
│   ├── kdt_main_window_full.py     메인 윈도우
│   ├── instructor_code_dialog.py   강사 코드 관리
│   ├── instructor_dialog.py        강사 관리
│   ├── subject_dialog.py           교과목 관리
│   ├── holiday_dialog.py           공휴일 관리
│   ├── course_dialog.py            과정 관리
│   ├── project_dialog.py           프로젝트 관리
│   ├── timetable_generate_dialog.py ⭐ 시간표 자동 생성
│   ├── timetable_view_dialog.py     ⭐ 시간표 조회/수정
│   └── pdf_report_dialog.py         ⭐ PDF 보고서 생성
│
└── utils/
    ├── excel_manager.py            Excel 처리
    ├── timetable_generator.py      ⭐ 시간표 생성 로직
    ├── pdf_generator.py            ⭐ PDF 생성 로직
    └── helpers.py                  헬퍼 함수
```

---

## 💾 필요한 패키지

```
PyQt5==5.15.11              # GUI 프레임워크
PyQt5-sip==12.17.1
pymysql==1.1.0              # MySQL 연결
pandas==2.1.4               # 데이터 처리
openpyxl==3.1.2             # Excel 읽기/쓰기
xlsxwriter==3.1.9           # Excel 쓰기
python-dateutil==2.8.2      # 날짜 처리
reportlab==4.0.7            # PDF 생성 ⭐
```

---

## 🎨 화면 구성

### 메인 화면
```
┌────────────────────────────────────────────────────┐
│  🏛️ 바이오헬스 융합인재 이노베이터 for KDT          │
│     교육 관리 시스템 v3.0                           │
├────────────────────────────────────────────────────┤
│ [👤 강사코드] [👨‍🏫 강사] [📚 교과목]                 │
│ [📅 공휴일] [🎓 과정] [💼 프로젝트]                  │
│ [📅 시간표생성] [🔍 시간표조회] [📄 PDF보고서]       │
│ [📊 Excel내보내기] [📥 Excel가져오기] [🔧 DB초기화]  │
└────────────────────────────────────────────────────┘
```

---

## 🎯 완성도

| 기능 | 상태 | 비고 |
|------|------|------|
| DB 연동 | ✅ 완료 | MySQL 실시간 연결 |
| 강사 코드 | ✅ 완료 | CRUD 완성 |
| 강사 관리 | ✅ 완료 | CRUD 완성 |
| 교과목 관리 | ✅ 완료 | CRUD 완성 |
| 공휴일 관리 | ✅ 완료 | 자동입력 포함 |
| 과정 관리 | ✅ 완료 | CRUD 완성 |
| 프로젝트 관리 | ✅ 완료 | 5명 구성원 |
| Excel 내보내기 | ✅ 완료 | 포맷팅 포함 |
| Excel 가져오기 | ✅ 완료 | 일괄 입력 |
| **시간표 자동 생성** | ✅ 완료 | **공휴일 자동 제외** |
| **시간표 조회/수정** | ✅ 완료 | **3가지 뷰** |
| **PDF 보고서** | ✅ 완료 | **3가지 양식** |

**완성도: 100%** 🎉

---

## 📞 문제 해결

### Q: reportlab 한글이 깨져요
```
A: Windows 환경에서는 자동으로 맑은 고딕 폰트를 사용합니다.
   C:/Windows/Fonts/malgun.ttf 경로가 있는지 확인하세요.
```

### Q: 시간표 생성이 안 돼요
```
A: 순서대로 확인:
   1. 공휴일이 등록되어 있나요?
   2. 교과목이 등록되어 있나요?
   3. 과정이 등록되어 있나요?
   4. 과정의 시수가 설정되어 있나요?
```

### Q: PDF 생성 시 오류가 나요
```
A: 시간표가 생성되어 있는지 확인하세요.
   시간표 → 시간표 자동 생성 먼저 실행
```

---

## 🏆 주요 특징

✨ **자동화**: 시간표 자동 생성, 공휴일 자동 제외
📊 **시각화**: 달력 뷰, 색상 구분, PDF 보고서
🔄 **통합**: Excel, PDF, DB 완벽 연동
🎨 **사용성**: 직관적인 UI, 편리한 필터링
💾 **안정성**: 트랜잭션 처리, 오류 처리

---

## 📜 라이선스

MIT License

---

## 👨‍💻 개발 정보

- **프로젝트**: KDT 교육 관리 시스템
- **버전**: 3.0.0 (완전판)
- **완성일**: 2025-10-21
- **기술 스택**: Python, PyQt5, MySQL, pandas, reportlab
- **코드 라인**: 10,000+ lines

---

**모든 기능이 완성되었습니다! 🎉**
**Happy Managing! 🎓**
